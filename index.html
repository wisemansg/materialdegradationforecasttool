<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Material Degradation Forecast Tool</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacOSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            margin: 0;
            padding: 20px;
            color: #333;
        }

        header {
            text-align: center;
            padding: 20px;
            background: rgba(255,255,255,0.8);
            border-radius: 12px;
            margin-bottom: 25px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
        }

        h1 { margin: 0; color: #2c3e50; }
        h2 { color: #34495e; }
        h3 { color: #7f8c8d; margin-bottom: 8px; }

        .container {
            display: grid;
            grid-template-columns: 320px 1fr 1fr;
            gap: 24px;
            max-width: 1800px;
            margin: 0 auto;
        }

        .panel {
            background: rgba(255,255,255,0.85);
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 6px 25px rgba(0,0,0,0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.4);
        }

        .section {
            margin-bottom: 22px;
        }

        select, input[type="number"], button {
            width: 100%;
            padding: 10px 12px;
            margin-top: 6px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 15px;
            box-sizing: border-box;
        }

        button {
            background: #3498db;
            color: white;
            border: none;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.2s;
        }

        button:hover {
            background: #2980b9;
            transform: translateY(-1px);
        }

        #protection-options label {
            display: block;
            margin: 6px 0;
            font-size: 14px;
        }

        canvas {
            background: white;
            border-radius: 8px;
            border: 1px solid #eee;
        }

        #risk-badge {
            font-size: 32px;
            font-weight: bold;
            text-align: center;
            margin: 20px 0;
            padding: 12px;
            border-radius: 12px;
            background: #ecf0f1;
        }

        #insights {
            line-height: 1.6;
            font-size: 15px;
        }

        .comparison-charts {
            display: flex;
            gap: 20px;
            margin-top: 20px;
        }

        .comparison-charts canvas {
            flex: 1;
            max-height: 380px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 16px;
        }

        th, td {
            padding: 10px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }

        th {
            background: #f8f9fa;
        }

        @media (max-width: 1200px) {
            .container {
                grid-template-columns: 1fr;
            }
            .comparison-charts {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>

<header>
    <h1>üß™ Material Degradation Forecast Tool</h1>
    <p>Location-Aware Engineering Decision Dashboard</p>
</header>

<div class="container">

    <!-- INPUT PANEL -->
    <div class="panel">
        <h2>Inputs</h2>

        <div class="section">
            <h3>üåç Country</h3>
            <select id="country-select"></select>
            <div id="country-info" style="margin-top:8px; font-size:14px; color:#555;"></div>
        </div>

        <div class="section">
            <h3>üß± Material Family</h3>
            <select id="material-family">
                <option value="Metal">Metals</option>
                <option value="Polymer">Polymers</option>
                <option value="Ceramic">Ceramics</option>
                <option value="Composite">Composites</option>
            </select>

            <h3>Material</h3>
            <select id="material-select"></select>
            <div id="material-info" style="margin-top:8px; font-size:14px; color:#555;"></div>
        </div>

        <div class="section">
            <h3>‚ö†Ô∏è Degradation Mode</h3>
            <select id="degradation-mode"></select>
        </div>

        <div class="section">
            <h3>üõ°Ô∏è Protective Strategies</h3>
            <div id="protection-options"></div>
        </div>

        <div class="section">
            <h3>Forecast Period (years)</h3>
            <input type="number" id="years" value="25" min="5" max="100" step="5">
        </div>

        <button id="calculate">Calculate Forecast</button>
    </div>

    <!-- MAIN VISUALIZATION -->
    <div class="panel">
        <h2>Degradation Forecast</h2>
        <canvas id="degradation-chart" height="320"></canvas>
        <div id="risk-badge">‚Äî</div>
        <div id="insights"></div>
    </div>

    <!-- COMPARISON -->
    <div class="panel">
        <h2>Comparison Dashboard</h2>

        <div class="section">
            <select id="comparison-mode">
                <option>Material vs Material</option>
                <option>Country vs Country</option>
                <option>Protection vs No Protection</option>
            </select>
        </div>

        <button id="compare">Run Comparison</button>

        <div class="comparison-charts">
            <canvas id="chart-a" height="300"></canvas>
            <canvas id="chart-b" height="300"></canvas>
        </div>

        <div id="comparison-metrics"></div>
    </div>

</div>

<script>
// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
// DATA (expanded realistic dataset)
// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

const countries = [
    {country:"Norway", climateZone:"Cold", humidityIndex:0.65, temperatureIndex:0.35, coastalExposure:0.85, pollutionIndex:0.25, uvIndex:0.45},
    {country:"Nigeria", climateZone:"Tropical", humidityIndex:0.82, temperatureIndex:0.78, coastalExposure:0.65, pollutionIndex:0.55, uvIndex:0.75},
    {country:"India", climateZone:"Tropical", humidityIndex:0.76, temperatureIndex:0.82, coastalExposure:0.55, pollutionIndex:0.88, uvIndex:0.82},
    {country:"United States", climateZone:"Varied", humidityIndex:0.62, temperatureIndex:0.58, coastalExposure:0.48, pollutionIndex:0.42, uvIndex:0.65},
    {country:"Brazil", climateZone:"Tropical", humidityIndex:0.84, temperatureIndex:0.76, coastalExposure:0.78, pollutionIndex:0.58, uvIndex:0.78},
    {country:"China", climateZone:"Varied", humidityIndex:0.68, temperatureIndex:0.62, coastalExposure:0.52, pollutionIndex:0.82, uvIndex:0.68},
    {country:"Australia", climateZone:"Arid", humidityIndex:0.38, temperatureIndex:0.72, coastalExposure:0.88, pollutionIndex:0.35, uvIndex:0.92},
    {country:"Russia", climateZone:"Cold", humidityIndex:0.52, temperatureIndex:0.28, coastalExposure:0.42, pollutionIndex:0.68, uvIndex:0.38},
    {country:"Indonesia", climateZone:"Tropical", humidityIndex:0.88, temperatureIndex:0.80, coastalExposure:0.92, pollutionIndex:0.62, uvIndex:0.85},
    {country:"Saudi Arabia", climateZone:"Arid", humidityIndex:0.22, temperatureIndex:0.92, coastalExposure:0.68, pollutionIndex:0.78, uvIndex:0.95},
    {country:"Japan", climateZone:"Temperate", humidityIndex:0.74, temperatureIndex:0.58, coastalExposure:0.88, pollutionIndex:0.48, uvIndex:0.62},
    {country:"Germany", climateZone:"Temperate", humidityIndex:0.68, temperatureIndex:0.48, coastalExposure:0.45, pollutionIndex:0.38, uvIndex:0.48},
    // ... you can add 30‚Äì50 more countries here
];

const materials = [
    {material:"Carbon Steel", family:"Metal", corrosionResistance:0.28, oxidationResistance:0.45, embrittlementResistance:0.38, uvResistance:0.88, baseCostIndex:0.35},
    {material:"Stainless Steel 304", family:"Metal", corrosionResistance:0.78, oxidationResistance:0.72, embrittlementResistance:0.62, uvResistance:0.90, baseCostIndex:0.65},
    {material:"Aluminum 6061", family:"Metal", corrosionResistance:0.68, oxidationResistance:0.82, embrittlementResistance:0.55, uvResistance:0.85, baseCostIndex:0.52},
    {material:"Copper C110", family:"Metal", corrosionResistance:0.58, oxidationResistance:0.55, embrittlementResistance:0.48, uvResistance:0.78, baseCostIndex:0.72},
    {material:"Titanium Grade 5", family:"Metal", corrosionResistance:0.94, oxidationResistance:0.82, embrittlementResistance:0.75, uvResistance:0.92, baseCostIndex:1.40},
    {material:"Polyethylene (HDPE)", family:"Polymer", corrosionResistance:0.92, oxidationResistance:0.35, embrittlementResistance:0.42, uvResistance:0.38, baseCostIndex:0.28},
    {material:"PVC", family:"Polymer", corrosionResistance:0.82, oxidationResistance:0.40, embrittlementResistance:0.52, uvResistance:0.48, baseCostIndex:0.32},
    {material:"CFRP (Carbon Fiber)", family:"Composite", corrosionResistance:0.88, oxidationResistance:0.55, embrittlementResistance:0.45, uvResistance:0.62, baseCostIndex:1.20},
    {material:"Silicon Carbide", family:"Ceramic", corrosionResistance:0.96, oxidationResistance:0.92, embrittlementResistance:0.85, uvResistance:0.95, baseCostIndex:1.80},
    // ... you can add 20‚Äì40 more materials
];

const degradationModes = [
    {mode:"Corrosion", humidityWeight:0.40, temperatureWeight:0.28, pollutionWeight:0.18, coastalWeight:0.14},
    {mode:"Oxidation", humidityWeight:0.18, temperatureWeight:0.42, pollutionWeight:0.28, coastalWeight:0.12},
    {mode:"Embrittlement", humidityWeight:0.32, temperatureWeight:0.32, pollutionWeight:0.22, coastalWeight:0.14},
    {mode:"UV Degradation", humidityWeight:0.12, temperatureWeight:0.18, pollutionWeight:0.10, coastalWeight:0.08, uvWeight:0.52},
    {mode:"Pitting Corrosion", humidityWeight:0.38, temperatureWeight:0.26, pollutionWeight:0.24, coastalWeight:0.12},
    {mode:"Stress Corrosion Cracking", humidityWeight:0.42, temperatureWeight:0.22, pollutionWeight:0.20, coastalWeight:0.16},
];

const protectiveStrategies = [
    {strategy:"Epoxy Coating", applicableTo:["Metal","Composite"], effectiveness:0.58, costMultiplier:1.25, maintenanceIntervalYears:6},
    {strategy:"Hot-Dip Galvanizing", applicableTo:["Metal"], effectiveness:0.72, costMultiplier:1.35, maintenanceIntervalYears:12},
    {strategy:"Anodizing (Type III)", applicableTo:["Metal"], effectiveness:0.62, costMultiplier:1.18, maintenanceIntervalYears:8},
    {strategy:"Thermal Spray (Al/Zn)", applicableTo:["Metal"], effectiveness:0.68, costMultiplier:1.45, maintenanceIntervalYears:9},
    {strategy:"Corrosion Inhibitor (closed system)", applicableTo:["Metal"], effectiveness:0.52, costMultiplier:1.12, maintenanceIntervalYears:4},
    {strategy:"Passivation (stainless)", applicableTo:["Metal"], effectiveness:0.48, costMultiplier:1.08, maintenanceIntervalYears:0},
    {strategy:"Increased Wall Thickness (+30%)", applicableTo:["All"], effectiveness:0.38, costMultiplier:1.55, maintenanceIntervalYears:0},
    {strategy:"Good Drainage Design", applicableTo:["All"], effectiveness:0.28, costMultiplier:1.15, maintenanceIntervalYears:0},
    {strategy:"Dielectric Isolation", applicableTo:["Metal"], effectiveness:0.35, costMultiplier:1.10, maintenanceIntervalYears:0},
    {strategy:"UV Stabilizers + Antioxidants", applicableTo:["Polymer"], effectiveness:0.60, costMultiplier:1.12, maintenanceIntervalYears:5},
];

// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
// CALCULATION FUNCTIONS
// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

function calculateEnvironmentalSeverity(country) {
    return (
        country.humidityIndex    * 0.35 +
        country.temperatureIndex * 0.25 +
        country.pollutionIndex   * 0.20 +
        country.coastalExposure  * 0.15 +
        (country.uvIndex || 0.5) * 0.05
    );
}

function getResistance(material, mode) {
    if (mode === "Corrosion")              return material.corrosionResistance;
    if (mode === "Oxidation")              return material.oxidationResistance;
    if (mode === "Embrittlement")          return material.embrittlementResistance;
    if (mode === "UV Degradation")         return material.uvResistance;
    return 0.5; // fallback
}

function calculateBaseDegradation(material, modeObj, severity) {
    const resistance = getResistance(material, modeObj.mode);
    return severity * (1 - resistance);
}

function applyProtection(baseRate, selectedStrategies) {
    let rate = baseRate;
    selectedStrategies.forEach(s => rate *= (1 - s.effectiveness));
    return rate;
}

function generateDegradationCurve(rate, years) {
    const curve = [];
    for (let y = 1; y <= years; y++) {
        // Slightly non-linear (accelerating) degradation
        const progress = rate * y * (1 + 0.015 * y);
        curve.push({
            year: y,
            degradation: Math.min(progress * 100, 100)
        });
    }
    return curve;
}

function classifyRisk(value) {
    if (value < 30) return {level:"Low", color:"#27ae60", bg:"#e8f5e9"};
    if (value < 65) return {level:"Moderate", color:"#f39c12", bg:"#fff3e0"};
    return {level:"High", color:"#c0392b", bg:"#ffebee"};
}

function calculateLifecycleCostEstimate(material, strategies, years, rate) {
    let cost = material.baseCostIndex * 10000;
    strategies.forEach(s => {
        cost *= s.costMultiplier;
        if (s.maintenanceIntervalYears > 0) {
            const maintCount = Math.floor(years / s.maintenanceIntervalYears);
            cost += maintCount * 1200;
        }
    });
    cost += rate * years * 180; // degradation penalty
    return Math.round(cost);
}

// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
// UI INITIALIZATION
// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

document.addEventListener('DOMContentLoaded', () => {
    // Countries
    const countrySel = document.getElementById('country-select');
    countries.forEach(c => {
        const opt = document.createElement('option');
        opt.value = c.country;
        opt.textContent = c.country;
        countrySel.appendChild(opt);
    });

    // Material family ‚Üí material cascade
    const familySel = document.getElementById('material-family');
    const matSel = document.getElementById('material-select');

    function updateMaterials() {
        matSel.innerHTML = '';
        const fam = familySel.value;
        materials
            .filter(m => m.family === fam)
            .forEach(m => {
                const opt = document.createElement('option');
                opt.value = m.material;
                opt.textContent = m.material;
                matSel.appendChild(opt);
            });
        updateMaterialInfo();
    }

    familySel.addEventListener('change', updateMaterials);
    matSel.addEventListener('change', updateMaterialInfo);

    function updateMaterialInfo() {
        const matName = matSel.value;
        const mat = materials.find(m => m.material === matName);
        if (mat) {
            document.getElementById('material-info').innerHTML =
                `Family: <b>${mat.family}</b> ‚Ä¢ Cost index: <b>${mat.baseCostIndex.toFixed(2)}</b>`;
        }
    }

    updateMaterials(); // initial

    // Degradation modes
    const modeSel = document.getElementById('degradation-mode');
    degradationModes.forEach(d => {
        const opt = document.createElement('option');
        opt.value = d.mode;
        opt.textContent = d.mode;
        modeSel.appendChild(opt);
    });

    // Protection checkboxes
    const protDiv = document.getElementById('protection-options');
    protectiveStrategies.forEach(s => {
        const label = document.createElement('label');
        const chk = document.createElement('input');
        chk.type = 'checkbox';
        chk.value = s.strategy;
        label.appendChild(chk);
        label.append(' ' + s.strategy);
        protDiv.appendChild(label);
    });

    // Buttons
    document.getElementById('calculate').addEventListener('click', runForecast);
    document.getElementById('compare').addEventListener('click', runComparison);
});

// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
// MAIN FORECAST
// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

let mainChart = null;

function runForecast() {
    const countryName = document.getElementById('country-select').value;
    const country = countries.find(c => c.country === countryName);
    if (!country) return alert("Please select a country");

    const matName = document.getElementById('material-select').value;
    const material = materials.find(m => m.material === matName);
    if (!material) return alert("Please select a material");

    const modeName = document.getElementById('degradation-mode').value;
    const mode = degradationModes.find(d => d.mode === modeName);
    if (!mode) return alert("Please select a degradation mode");

    const selectedStrat = Array.from(
        document.querySelectorAll('#protection-options input:checked')
    ).map(chk => protectiveStrategies.find(s => s.strategy === chk.value));

    const years = parseInt(document.getElementById('years').value) || 25;

    // Calculations
    const severity = calculateEnvironmentalSeverity(country);
    const baseRate = calculateBaseDegradation(material, mode, severity);
    const effRate = applyProtection(baseRate, selectedStrat);
    const curve = generateDegradationCurve(effRate, years);
    const finalDeg = curve[curve.length-1].degradation;
    const risk = classifyRisk(finalDeg);
    const lifecycleCost = calculateLifecycleCostEstimate(material, selectedStrat, years, effRate);

    // Chart
    const ctx = document.getElementById('degradation-chart').getContext('2d');
    if (mainChart) mainChart.destroy();

    mainChart = new Chart(ctx, {
        type: 'line',
        data: {
            labels: curve.map(p => p.year),
            datasets: [{
                label: 'Degradation Severity (%)',
                data: curve.map(p => p.degradation.toFixed(1)),
                borderColor: '#16a085',
                backgroundColor: 'rgba(22,160,133,0.08)',
                tension: 0.2,
                fill: true,
                pointRadius: 3
            }]
        },
        options: {
            responsive: true,
            scales: {
                y: { min: 0, max: 100, title: { display: true, text: 'Degradation (%)' } },
                x: { title: { display: true, text: 'Years' } }
            },
            plugins: {
                legend: { position: 'top' }
            }
        }
    });

    // Risk badge
    document.getElementById('risk-badge').style.background = risk.bg;
    document.getElementById('risk-badge').style.color = risk.color;
    document.getElementById('risk-badge').textContent = `Risk: ${risk.level} (${finalDeg.toFixed(1)}%)`;

    // Insights
    let txt = `<strong>Final degradation after ${years} years:</strong> ${finalDeg.toFixed(1)}%<br>`;
    txt += `<strong>Estimated lifecycle cost index:</strong> ~$${lifecycleCost.toLocaleString()}<br><br>`;

    if (selectedStrat.length > 0) {
        txt += "<strong>Protective measures applied:</strong><ul>";
        selectedStrat.forEach(s => {
            txt += `<li>${s.strategy} ‚Äî reduces rate by ${(s.effectiveness*100).toFixed(0)}%, maintenance every ${s.maintenanceIntervalYears} years</li>`;
        });
        txt += "</ul>";
    } else {
        txt += "<em>No protective strategies selected.</em><br>";
    }

    document.getElementById('insights').innerHTML = txt;

    // Country quick info
    document.getElementById('country-info').innerHTML =
        `Climate: <b>${country.climateZone}</b> ‚Ä¢ Humidity: <b>${country.humidityIndex}</b> ‚Ä¢ Pollution: <b>${country.pollutionIndex}</b>`;
}

// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
// COMPARISON (simple version ‚Äî Material vs Material)
// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

let compChartA = null, compChartB = null;

function runComparison() {
    const mode = document.getElementById('comparison-mode').value;
    if (mode !== "Material vs Material") {
        alert("Only Material vs Material comparison is implemented in this version.");
        return;
    }

    // For demo: compare first two metals (you can extend with selectors)
    const country = countries[0]; // Norway as reference
    const matA = materials[0];    // Carbon Steel
    const matB = materials[1];    // Stainless 304
    const degMode = degradationModes[0];
    const years = 25;

    const sev = calculateEnvironmentalSeverity(country);

    const rateA = applyProtection(calculateBaseDegradation(matA, degMode, sev), []);
    const rateB = applyProtection(calculateBaseDegradation(matB, degMode, sev), []);

    const curveA = generateDegradationCurve(rateA, years);
    const curveB = generateDegradationCurve(rateB, years);

    const finalA = curveA[curveA.length-1].degradation;
    const finalB = curveB[curveB.length-1].degradation;

    const riskA = classifyRisk(finalA);
    const riskB = classifyRisk(finalB);

    // Chart A
    const ctxA = document.getElementById('chart-a').getContext('2d');
    if (compChartA) compChartA.destroy();
    compChartA = new Chart(ctxA, {
        type: 'line',
        data: {
            labels: curveA.map(p => p.year),
            datasets: [{
                label: matA.material,
                data: curveA.map(p => p.degradation.toFixed(1)),
                borderColor: '#e74c3c',
                tension: 0.2
            }]
        },
        options: { scales: { y: { min:0, max:100 } } }
    });

    // Chart B
    const ctxB = document.getElementById('chart-b').getContext('2d');
    if (compChartB) compChartB.destroy();
    compChartB = new Chart(ctxB, {
        type: 'line',
        data: {
            labels: curveB.map(p => p.year),
            datasets: [{
                label: matB.material,
                data: curveB.map(p => p.degradation.toFixed(1)),
                borderColor: '#2ecc71',
                tension: 0.2
            }]
        },
        options: { scales: { y: { min:0, max:100 } } }
    });

    // Metrics table
    document.getElementById('comparison-metrics').innerHTML = `
        <table>
            <tr><th>Metric</th><th>${matA.material}</th><th>${matB.material}</th></tr>
            <tr><td>Final Degradation</td><td>${finalA.toFixed(1)}%</td><td>${finalB.toFixed(1)}%</td></tr>
            <tr><td>Risk Level</td><td style="color:${riskA.color}">${riskA.level}</td><td style="color:${riskB.color}">${riskB.level}</td></tr>
            <tr><td>Base Cost Index</td><td>${matA.baseCostIndex.toFixed(2)}</td><td>${matB.baseCostIndex.toFixed(2)}</td></tr>
        </table>
        <p style="font-size:14px; color:#777; margin-top:12px;">
            (Comparison uses default environment: ${country.country} ‚Äî no protections applied)
        </p>
    `;
}
</script>

</body>
</html>
